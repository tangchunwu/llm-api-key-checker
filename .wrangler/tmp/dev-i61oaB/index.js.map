{
  "version": 3,
  "sources": ["../../../src/utils/security.js", "../../../src/utils/cors.js", "../../../src/utils/userAgent.js", "../../../src/utils/fetcher.js", "../../../src/utils/url.js", "../../../src/checkers.js", "../../../config/providers.json", "../../../src/websocket_handler.js", "../../../src/model_fetchers.js", "../../../src/index.js", "../../../node_modules/wrangler/templates/middleware/middleware-ensure-req-body-drained.ts", "../../../node_modules/wrangler/templates/middleware/middleware-miniflare3-json-error.ts", "../bundle-Ctkbme/middleware-insertion-facade.js", "../../../node_modules/wrangler/templates/middleware/common.ts", "../bundle-Ctkbme/middleware-loader.entry.ts"],
  "sourceRoot": "E:\\llm-api-key-checker\\.wrangler\\tmp\\dev-i61oaB",
  "sourcesContent": ["/**\n * @description \u4ECE\u73AF\u5883\u53D8\u91CF\u4E2D\u89E3\u6790\u5141\u8BB8\u7684 CORS \u6765\u6E90\u767D\u540D\u5355\u3002\n * \u9884\u671F\u73AF\u5883\u53D8\u91CF `ALLOWED_ORIGINS` \u4E3A JSON \u5B57\u7B26\u4E32\u6570\u7EC4\uFF0C\u4F8B\u5982 `'[\"https://example.com\",\"https://*.example.com\"]''`\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @returns {string[]} - \u89E3\u6790\u540E\u7684\u5141\u8BB8\u6765\u6E90\u6570\u7EC4\uFF0C\u5982\u679C\u89E3\u6790\u5931\u8D25\u5219\u8FD4\u56DE\u7A7A\u6570\u7EC4\u3002\n */\nexport function getAllowedOrigins(env) {\n    try {\n        return JSON.parse(env.ALLOWED_ORIGINS || \"[]\");\n    } catch (e) {\n        return [];\n    }\n}\n\n/**\n * @description \u6821\u9A8C\u8BF7\u6C42\u7684 Origin \u662F\u5426\u5728\u5141\u8BB8\u7684\u767D\u540D\u5355\u8303\u56F4\u5185\u3002\n * \u652F\u6301\u5B50\u57DF\u901A\u914D\u7B26\uFF08\u4F8B\u5982 `https://*.example.com`\uFF09\u3002\n * @param {string} origin - \u8BF7\u6C42\u5934\u4E2D\u7684 Origin \u5B57\u7B26\u4E32\u3002\n * @param {string[]} allowedOrigins - \u5141\u8BB8\u7684 Origin \u767D\u540D\u5355\u6570\u7EC4\u3002\n * @returns {string|null} - \u5982\u679C Origin \u5408\u6CD5\uFF0C\u5219\u8FD4\u56DE\u5B9E\u9645\u7684 Origin \u5B57\u7B26\u4E32\uFF1B\u5426\u5219\u8FD4\u56DE `null`\u3002\n */\nexport function validateOrigin(origin, allowedOrigins) {\n    if (!origin) return null;\n\n    for (const rule of allowedOrigins) {\n        // \u7CBE\u786E\u5339\u914D\n        if (rule === origin) return origin;\n\n        // \u901A\u914D\u7B26\u6A21\u5F0F\u5339\u914D\uFF08\u9650\u5236\u53EA\u5339\u914D\u5355\u5C42\u5B50\u57DF\u540D\uFF09\n        if (rule.includes(\"*\")) {\n            const regex = new RegExp(\"^\" + rule\n                .replace(/\\./g, \"\\\\.\") // \u8F6C\u4E49\u70B9\n                .replace(/\\*/g, \"[^.]+\") + \"$\" // \u5C06\u661F\u53F7\u8F6C\u6362\u4E3A\u5339\u914D\u4E0D\u5305\u542B\u70B9\u7684\u5B57\u7B26\u4E32\uFF08\u5355\u5C42\u5B50\u57DF\u540D\uFF09\n            );\n            if (regex.test(origin)) return origin;\n        }\n    }\n    return null;\n}\n\n/**\n * @description \u6821\u9A8C\u76EE\u6807 URL \u7684\u5B89\u5168\u6027\uFF0C\u9632\u6B62 SSRF\uFF08Server-Side Request Forgery\uFF09\u653B\u51FB\u3002\n * \u5141\u8BB8 HTTP/HTTPS \u534F\u8BAE\uFF0C\u5E76\u7981\u6B62\u8BBF\u95EE\u5E38\u89C1\u7684\u5185\u7F51\u5730\u5740\u3002\n * @param {string} targetUrl - \u5F85\u6821\u9A8C\u7684\u76EE\u6807 URL \u5B57\u7B26\u4E32\u3002\n * @returns {boolean} - \u5982\u679C URL \u5B89\u5168\u5219\u8FD4\u56DE `true`\uFF0C\u5426\u5219\u8FD4\u56DE `false`\u3002\n */\nexport function validateTargetUrl(targetUrl) {\n    try {\n        const url = new URL(targetUrl);\n\n        // \u53EA\u5141\u8BB8 HTTP/HTTPS \u534F\u8BAE\n        if (![\"http:\", \"https:\"].includes(url.protocol)) {\n            throw new Error(\"\u53EA\u5141\u8BB8 HTTP/HTTPS \u534F\u8BAE\");\n        }\n\n        const hostname = url.hostname;\n\n        // \u7981\u6B62\u8BBF\u95EE\u5E38\u89C1\u7684\u5185\u7F51 IP \u8303\u56F4\u548C localhost\n        const forbidden = [\n            \"127.\", \"10.\", \"192.168.\", \"169.254.\", \"localhost\",\n            // 172.16.0.0/12 \u8303\u56F4 (172.16.x.x - 172.31.x.x)\n            \"172.16.\", \"172.17.\", \"172.18.\", \"172.19.\",\n            \"172.20.\", \"172.21.\", \"172.22.\", \"172.23.\",\n            \"172.24.\", \"172.25.\", \"172.26.\", \"172.27.\",\n            \"172.28.\", \"172.29.\", \"172.30.\", \"172.31.\",\n            // \u5176\u4ED6\u7279\u6B8A\u5730\u5740\n            \"0.0.0.0\", \"0.\", \"::1\", \"[::1]\"\n        ];\n        if (forbidden.some((prefix) => hostname.startsWith(prefix) || hostname === prefix.replace(/\\.$/, ''))) {\n            throw new Error(\"\u76EE\u6807\u5730\u5740\u4E0D\u5141\u8BB8\u8BBF\u95EE\u5185\u7F51\");\n        }\n\n        // \u989D\u5916\u68C0\u67E5\uFF1A\u9632\u6B62 IPv6 \u672C\u5730\u5730\u5740\n        if (hostname.startsWith('[') && (hostname.includes('::1') || hostname.toLowerCase().includes('fe80'))) {\n            throw new Error(\"\u76EE\u6807\u5730\u5740\u4E0D\u5141\u8BB8\u8BBF\u95EE\u672C\u5730 IPv6\");\n        }\n\n        return true;\n    } catch (err) {\n        // \u4EFB\u4F55\u89E3\u6790\u6216\u6821\u9A8C\u9519\u8BEF\u90FD\u89C6\u4E3A\u4E0D\u5B89\u5168\n        return false;\n    }\n}\n", "import { getAllowedOrigins, validateOrigin } from \"./security.js\";\n\n/**\n * @description \u57FA\u4E8E\u8BF7\u6C42\u548C\u73AF\u5883\u914D\u7F6E\u751F\u6210 CORS Header\u3002\n * @param {Request} request - \u4F20\u5165\u7684\u8BF7\u6C42\u5BF9\u8C61\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @returns {object} - \u5305\u542B CORS \u5934\u7684\u5BF9\u8C61\u3002\n */\nexport function corsHeaders(request, env) {\n    const origin = request.headers.get(\"Origin\") || \"\";\n    const allowedOrigins = getAllowedOrigins(env);\n    const validOrigin = validateOrigin(origin, allowedOrigins);\n\n    const headers = {\n        \"Access-Control-Allow-Methods\": \"GET, POST, OPTIONS\",\n        \"Access-Control-Allow-Headers\": \"Content-Type, Authorization, x-api-key, x-goog-api-key, anthropic-version, anthropic-dangerous-direct-browser-access\",\n        \"Access-Control-Max-Age\": \"86400\",\n        \"X-Robots-Tag\": \"noindex, nofollow\",\n        \"Vary\": \"Origin\",\n        \"X-Content-Type-Options\": \"nosniff\",\n        \"Referrer-Policy\": \"strict-origin-when-cross-origin\",\n        \"Content-Security-Policy\": \"default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self';\"\n    };\n\n    if (validOrigin) {\n        headers[\"Access-Control-Allow-Origin\"] = validOrigin;\n    }\n\n    return headers;\n}\n\n/**\n * @description \u5904\u7406 CORS \u9884\u68C0\u8BF7\u6C42\uFF08OPTIONS \u65B9\u6CD5\uFF09\u3002\n * @param {Request} request - \u4F20\u5165\u7684\u8BF7\u6C42\u5BF9\u8C61\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Response} - \u9884\u68C0\u8BF7\u6C42\u7684\u54CD\u5E94\u3002\n */\nexport function handleOptions(request, env) {\n    const headers = corsHeaders(request, env);\n    return new Response(null, {\n        status: headers[\"Access-Control-Allow-Origin\"] ? 204 : 403,\n        headers,\n    });\n}\n", "/**\n * @description UserAgentManager \u7C7B\u7528\u4E8E\u7BA1\u7406 User-Agent \u548C Accept-Language \u5934\u7684\u968F\u673A\u5316\u3002\n * \u65E8\u5728\u6A21\u62DF\u771F\u5B9E\u7528\u6237\u884C\u4E3A\uFF0C\u907F\u514D\u88AB\u76EE\u6807\u670D\u52A1\u5668\u8BC6\u522B\u4E3A\u81EA\u52A8\u5316\u8BF7\u6C42\u3002\n */\nexport class UserAgentManager {\n    constructor() {\n        /** @type {string[]} \u9884\u5B9A\u4E49\u7684 User-Agent \u5B57\u7B26\u4E32\u5217\u8868\u3002*/\n        this.userAgents = [\n            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36',\n            'Mozilla/5.0 (iPhone; CPU iPhone OS 17_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) CriOS/123.0.6312.52 Mobile/15E148 Safari/604.1',\n            'Mozilla/5.0 (iPhone; CPU iPhone OS 17_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4.1 Mobile/15E148 Safari/604.1',\n            'Mozilla/5.0 (Linux; Android 10; K) AppleWebKit/537.36 (KHTML, like Gecko) SamsungBrowser/24.0 Chrome/117.0.0.0 Mobile Safari/537.36',\n            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36',\n            'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/136.0.0.0 Safari/537.36 Edg/136.0.0.0',\n            'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:124.0) Gecko/20100101 Firefox/124.0',\n            'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.4 Safari/605.1.15',\n            'Mozilla/5.0 (Linux; Android 13; SM-S908U) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Mobile Safari/537.36',\n            'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36'\n        ];\n        /** @type {string[]} \u9884\u5B9A\u4E49\u7684 Accept-Language \u5B57\u7B26\u4E32\u5217\u8868\u3002*/\n        this.acceptLanguages = [\n            'zh-CN,zh;q=0.9,en;q=0.8',\n            'zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7',\n            'zh-CN,zh;q=0.9',\n            'en-US,en;q=0.9',\n            'en-US,en;q=0.9,es;q=0.8',\n            'en-US,en;q=0.9,zh-CN;q=0.8,zh;q=0.7',\n            'en-GB,en;q=0.9',\n            'en-GB,en-US;q=0.9,en;q=0.8',\n            'en-GB,en;q=0.9,fr;q=0.8',\n            'en-SG,en;q=0.9,zh-CN;q=0.8,zh;q=0.7',\n            'zh-CN,zh;q=0.9,en-SG;q=0.8,en;q=0.7',\n            'en-SG,en;q=0.9,ms;q=0.8'\n        ];\n    }\n\n    /**\n     * @description \u4ECE\u9884\u5B9A\u4E49\u7684 User-Agent \u5217\u8868\u4E2D\u968F\u673A\u83B7\u53D6\u4E00\u4E2A\u3002\n     * @returns {string} \u968F\u673A\u7684 User-Agent \u5B57\u7B26\u4E32\u3002\n     */\n    getRandomUserAgent() {\n        return this.userAgents[Math.floor(Math.random() * this.userAgents.length)];\n    }\n\n    /**\n     * @description \u4ECE\u9884\u5B9A\u4E49\u7684 Accept-Language \u5217\u8868\u4E2D\u968F\u673A\u83B7\u53D6\u4E00\u4E2A\u3002\n     * @returns {string} \u968F\u673A\u7684 Accept-Language \u5B57\u7B26\u4E32\u3002\n     */\n    getRandomAcceptLanguage() {\n        return this.acceptLanguages[Math.floor(Math.random() * this.acceptLanguages.length)];\n    }\n}\n", "import { validateTargetUrl } from './security.js';\nimport { UserAgentManager } from './userAgent.js';\n\n/**\n * @description \u5355\u4F8B UserAgentManager \u5B9E\u4F8B\uFF0C\u907F\u514D\u6BCF\u6B21\u8BF7\u6C42\u90FD\u521B\u5EFA\u65B0\u5B9E\u4F8B\u3002\n */\nconst uaManager = new UserAgentManager();\n\n/**\n * @description \u5B89\u5168\u5730\u53D1\u8D77\u4EE3\u7406\u8BF7\u6C42\u7684\u901A\u7528\u51FD\u6570\u3002\u5B83\u4F1A\u6839\u636E\u914D\u7F6E\u51B3\u5B9A\u662F\u5426\u901A\u8FC7 Durable Object \u8FDB\u884C\u533A\u57DF\u4EE3\u7406\u3002\n * @param {string} url - \u76EE\u6807 URL\u3002\n * @param {RequestInit} options - fetch \u8BF7\u6C42\u7684\u9009\u9879\u3002\n * @param {string} region - \u6307\u5B9A\u7684\u533A\u57DF\u540D\u79F0\uFF0C\u7528\u4E8E Durable Object \u4EE3\u7406\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<Response>} - fetch \u8BF7\u6C42\u7684\u54CD\u5E94\u3002\n */\nexport async function secureProxiedFetch(url, options, region, env) {\n    if (!validateTargetUrl(url)) {\n        return new Response(JSON.stringify({ error: { message: 'Invalid or forbidden target URL' } }), {\n            status: 400,\n            headers: { 'Content-Type': 'application/json' },\n        });\n    }\n\n    const enableUaRandomization = env.ENABLE_UA_RANDOMIZATION !== 'false';\n    const enableAcceptLanguageRandomization = env.ENABLE_ACCEPT_LANGUAGE_RANDOMIZATION !== 'false';\n\n    const finalHeaders = { ...options.headers };\n\n    if (enableUaRandomization) {\n        const randomUA = uaManager.getRandomUserAgent();\n        if (randomUA) finalHeaders['user-agent'] = randomUA;\n    }\n\n    if (enableAcceptLanguageRandomization) {\n        const randomAcceptLanguage = uaManager.getRandomAcceptLanguage();\n        if (randomAcceptLanguage) finalHeaders['accept-language'] = randomAcceptLanguage;\n    }\n\n    const finalOptions = { ...options, headers: finalHeaders };\n\n    // \u5982\u679C\u6CA1\u6709\u6307\u5B9A\u533A\u57DF\u6216\u6CA1\u6709 Durable Object \u7ED1\u5B9A\uFF0C\u5219\u76F4\u63A5\u53D1\u8D77\u8BF7\u6C42\n    if (!region || !env.REGIONAL_FETCHER) {\n        return fetch(url, finalOptions);\n    }\n\n    // \u901A\u8FC7 Durable Object \u8FDB\u884C\u533A\u57DF\u4EE3\u7406\n    try {\n        const doId = env.REGIONAL_FETCHER.idFromName(region);\n        const doStub = env.REGIONAL_FETCHER.get(doId, { location: region });\n\n        // \u5C06\u8BF7\u6C42\u7684\u8BE6\u7EC6\u4FE1\u606F\u4F5C\u4E3A payload \u53D1\u9001\u7ED9 Durable Object\n        const payload = {\n            targetUrl: url,\n            method: finalOptions.method,\n            headers: finalOptions.headers,\n            body: finalOptions.body,\n        };\n        \n        // \u3010\u4F18\u5316\u3011\u4E3A\u4E86\u8BA9\u5185\u90E8\u4EE3\u7406\u8BF7\u6C42\u7684\u65E5\u5FD7\u66F4\u5177\u53EF\u8BFB\u6027\uFF0C\u5C06\u76EE\u6807\u4E3B\u673A\u540D\u6DFB\u52A0\u5230\u5185\u90E8 URL \u4E2D\u3002\n        // \u8FD9\u4F1A\u5C06\u65E5\u5FD7\u6761\u76EE\u4ECE \"POST http://do.internal/proxy\" \u53D8\u4E3A\u7C7B\u4F3C \"POST http://do.internal/proxy/api.openai.com\"\n        // \u8FD9\u4E0D\u4F1A\u5F71\u54CD Durable Object \u7684\u529F\u80FD\uFF0C\u56E0\u4E3A DO stub \u7684 fetch \u8C03\u7528\u4E0D\u5173\u5FC3\u8FD9\u4E2A\u5185\u90E8 URL \u7684\u8DEF\u5F84\u3002\n        const targetHostname = new URL(url).hostname;\n        const internalUrl = `http://do.internal/proxy/${targetHostname}`;\n\n        const proxyRequestToDO = new Request(internalUrl, {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify(payload)\n        });\n\n        return doStub.fetch(proxyRequestToDO);\n    } catch (error) {\n        console.error(`Durable Object fetch failed for region ${region}:`, error);\n        // \u5982\u679C Durable Object \u8C03\u7528\u5931\u8D25\uFF0C\u5219\u56DE\u9000\u5230\u76F4\u63A5\u53D1\u8D77\u8BF7\u6C42\n        return fetch(url, finalOptions);\n    }\n}\n", "/**\n * @description \u89C4\u8303\u5316 baseUrl\uFF0C\u79FB\u9664\u5C3E\u90E8\u7684\u659C\u6760\u3002\n * @param {string} url - \u9700\u8981\u89C4\u8303\u5316\u7684 URL\u3002\n * @returns {string} - \u89C4\u8303\u5316\u540E\u7684 URL\u3002\n */\nexport function normalizeBaseUrl(url) {\n    return url.replace(/\\/+$/, \"\");\n}\n", "import { secureProxiedFetch } from './utils/fetcher.js';\nimport { normalizeBaseUrl } from './utils/url.js';\n\n/**\n * @description \u4F59\u989D\u83B7\u53D6\u5931\u8D25\u65F6\u7684\u9ED8\u8BA4\u8FD4\u56DE\u503C\u3002\n */\nconst BALANCE_UNAVAILABLE = { balance: -1, message: \"\u6709\u6548\u4F46\u65E0\u6CD5\u83B7\u53D6\u4F59\u989D\" };\n\n/**\n * @description \u5305\u542B\u6240\u6709\u7279\u5B9A\u4E8E\u63D0\u4F9B\u5546\u7684\u4F59\u989D\u68C0\u67E5\u903B\u8F91\u3002\n * \u6BCF\u4E2A\u51FD\u6570\u63A5\u6536 token, baseUrl, region, \u548C env\uFF0C\u5E76\u8FD4\u56DE\u4E00\u4E2A\u5305\u542B\u4F59\u989D\u4FE1\u606F\u7684\u5BF9\u8C61\u3002\n */\nconst balanceCheckers = {\n    async checkOpenRouterBalance(token, baseUrl, region, env) {\n        const creditsUrl = normalizeBaseUrl(baseUrl).replace(\"/v1\", \"\") + \"/v1/credits\";\n        const creditsResponse = await secureProxiedFetch(creditsUrl, { method: \"GET\", headers: { Authorization: \"Bearer \" + token } }, region, env);\n        if (creditsResponse.ok) {\n            const d = await creditsResponse.json();\n            const total = d.data?.total_credits || 0;\n            const usage = d.data?.total_usage || 0;\n            return {\n                balance: parseFloat((total - usage).toFixed(4)),\n                totalBalance: total,\n                usedBalance: usage,\n                rawBalanceResponse: d,\n            };\n        }\n        return BALANCE_UNAVAILABLE;\n    },\n    async checkSiliconFlowBalance(token, baseUrl, region, env) {\n        const resp = await secureProxiedFetch(normalizeBaseUrl(baseUrl).replace(\"/v1\", \"\") + \"/v1/user/info\", { method: \"GET\", headers: { Authorization: \"Bearer \" + token } }, region, env);\n        if (resp.ok) {\n            const d = await resp.json();\n            const bal = parseFloat(d.data?.balance);\n            return {\n                balance: isNaN(bal) ? -1 : parseFloat(bal.toFixed(4)),\n                rawBalanceResponse: d,\n            };\n        }\n        return BALANCE_UNAVAILABLE;\n    },\n    async checkDeepSeekBalance(token, baseUrl, region, env) {\n        const resp = await secureProxiedFetch(\n            normalizeBaseUrl(baseUrl).replace(\"/v1\", \"\") + \"/user/balance\",\n            { method: \"GET\", headers: { Authorization: \"Bearer \" + token, Accept: \"application/json\" } },\n            region, env\n        );\n        if (resp.ok) {\n            const d = await resp.json();\n            const info = d.balance_infos?.find((b) => b.currency === \"USD\") || d.balance_infos?.find((b) => b.currency === \"CNY\") || d.balance_infos?.[0];\n            if (info) {\n                return {\n                    balance: parseFloat(info.total_balance),\n                    currency: info.currency,\n                    grantedBalance: parseFloat(info.granted_balance || 0),\n                    toppedUpBalance: parseFloat(info.topped_up_balance || 0),\n                    rawBalanceResponse: d,\n                };\n            }\n        }\n        return BALANCE_UNAVAILABLE;\n    },\n    async checkMoonshotBalance(token, baseUrl, region, env) {\n        const balanceResponse = await secureProxiedFetch(normalizeBaseUrl(baseUrl) + \"/users/me/balance\", { method: \"GET\", headers: { Authorization: \"Bearer \" + token } }, region, env);\n        if (balanceResponse.ok) {\n            const data = await balanceResponse.json();\n            return {\n                balance: parseFloat(data.data?.available_balance) || -1,\n                rawBalanceResponse: data,\n            };\n        }\n        return BALANCE_UNAVAILABLE;\n    },\n    async checkNewAPIBalance(token, baseUrl, region, env) {\n        const creditsUrl = normalizeBaseUrl(baseUrl).replace(\"/v1\", \"\") + \"/api/usage/token\";\n        const response = await secureProxiedFetch(\n            creditsUrl,\n            { method: \"GET\", headers: { Authorization: \"Bearer \" + token } },\n            region, env\n        );\n        if (response.ok) {\n            const d = await response.json();\n            if (d.code === true && d.data) {\n                const tokenToUsdRate = 500000;\n                const availableUsd = parseFloat((d.data.total_available / tokenToUsdRate).toFixed(2));\n                const grantedUsd = parseFloat((d.data.total_granted / tokenToUsdRate).toFixed(2));\n                return {\n                    balance: availableUsd,\n                    totalGranted: grantedUsd,\n                    expiresAt: d.data.expires_at,\n                    currency: 'USD',\n                    rawBalanceResponse: d,\n                };\n            }\n        }\n        return BALANCE_UNAVAILABLE;\n    },\n};\n\n/**\n * @description \u7EDF\u4E00\u5904\u7406\u4E0A\u6E38 API \u7684\u9519\u8BEF\u54CD\u5E94\uFF0C\u63D0\u53D6\u5173\u952E\u9519\u8BEF\u4FE1\u606F\u3002\n * @param {Response} response - fetch API \u8FD4\u56DE\u7684 Response \u5BF9\u8C61\u3002\n * @returns {Promise<{message: string, rawError: object, errorCategory: string}>} - \u5305\u542B\u683C\u5F0F\u5316\u6D88\u606F\u3001\u539F\u59CB\u9519\u8BEF\u548C\u9519\u8BEF\u5206\u7C7B\u7684\u5BF9\u8C61\u3002\n */\nasync function handleApiError(response) {\n    const rawText = await response.text();\n    let rawErrorContent;\n    try {\n        rawErrorContent = JSON.parse(rawText);\n    } catch (e) {\n        rawErrorContent = rawText;\n    }\n    let message;\n    let errorCategory = 'unknown'; // \u65B0\u589E\uFF1A\u9519\u8BEF\u5206\u7C7B\n    const reason = rawErrorContent?.error?.details?.[0]?.reason;\n    const code = rawErrorContent?.error?.code;\n    const errorType = rawErrorContent?.error?.type;\n    const errorMessage = rawErrorContent?.error?.message;\n    const topLevelMessage = rawErrorContent?.message;\n    const detail = rawErrorContent?.detail;\n    const lowerCaseContent = JSON.stringify(rawErrorContent).toLowerCase();\n\n    // \u4F18\u5148\u7EA7\u4ECE\u9AD8\u5230\u4F4E\u8FDB\u884C\u9519\u8BEF\u5206\u7C7B\n    if (response.status === 401 || code === 'invalid_api_key' || errorType === 'invalid_api_key') {\n        message = \"API Key \u65E0\u6548\u6216\u683C\u5F0F\u9519\u8BEF\";\n        errorCategory = 'invalid_key';\n    } else if (errorType === 'access_terminated' || lowerCaseContent.includes('terminated') || lowerCaseContent.includes('banned')) {\n        message = \"\u8D26\u6237\u5DF2\u88AB\u5C01\u7981\u6216\u505C\u7528\";\n        errorCategory = 'account_banned';\n    } else if (response.status === 402 || code === 'insufficient_quota' || errorType === 'insufficient_quota') {\n        message = \"\u989D\u5EA6\u4E0D\u8DB3\";\n        errorCategory = 'no_quota';\n    } else if (response.status === 429) {\n        message = \"\u8BF7\u6C42\u9891\u7E41 (Rate Limit)\";\n        errorCategory = 'rate_limit';\n    } else if (response.status === 403 || lowerCaseContent.includes('permission') || lowerCaseContent.includes('forbidden')) {\n        message = \"\u8BBF\u95EE\u88AB\u62D2\u7EDD (\u6743\u9650\u4E0D\u8DB3)\";\n        errorCategory = 'permission_denied';\n    } else if (lowerCaseContent.includes('location') || lowerCaseContent.includes('region') || lowerCaseContent.includes('country')) {\n        message = \"\u533A\u57DF\u9650\u5236\";\n        errorCategory = 'region_blocked';\n    } else if (code === 'model_not_found' || lowerCaseContent.includes('model') && lowerCaseContent.includes('not found')) {\n        message = \"\u6A21\u578B\u4E0D\u5B58\u5728\u6216\u4E0D\u53EF\u7528\";\n        errorCategory = 'model_not_found';\n    } else if (reason) {\n        message = String(reason);\n    } else if (code && isNaN(code)) {\n        message = String(code);\n    } else if (errorMessage) {\n        message = String(errorMessage);\n    } else if (topLevelMessage) {\n        message = String(topLevelMessage);\n    } else if (rawErrorContent?.errors?.message) {\n        message = String(rawErrorContent.errors.message);\n    } else if (detail) {\n        message = typeof detail === 'object' ? JSON.stringify(detail) : String(detail);\n    } else {\n        message = `HTTP ${response.status}`;\n    }\n\n    return {\n        message,\n        errorCategory,\n        rawError: {\n            status: response.status,\n            content: rawErrorContent,\n        },\n    };\n}\n\n/**\n * @description \u901A\u7528\u7684 API Key \u68C0\u6D4B\u6A21\u677F\u51FD\u6570\uFF0C\u5C01\u88C5\u4E86\u8BF7\u6C42\u3001\u54CD\u5E94\u3001\u9519\u8BEF\u5904\u7406\u548C\u91CD\u8BD5\u7684\u901A\u7528\u903B\u8F91\u3002\n * @param {string} token - \u8981\u68C0\u6D4B\u7684 API Key\u3002\n * @param {object} providerMeta - \u63D0\u4F9B\u5546\u7684\u5143\u6570\u636E\uFF0C\u6765\u81EA providers.json\u3002\n * @param {object} providerConfig - \u7528\u6237\u914D\u7F6E\u7684\u63D0\u4F9B\u5546\u4FE1\u606F\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @param {object} strategy - \u5B9A\u4E49\u4E86\u5982\u4F55\u6784\u5EFA\u8BF7\u6C42\u548C\u5904\u7406\u5931\u8D25\u7684\u7B56\u7565\u5BF9\u8C61\u3002\n * @returns {Promise<object>} - \u68C0\u6D4B\u7ED3\u679C\u5BF9\u8C61\u3002\n */\nasync function _checkTokenTemplate(token, providerMeta, providerConfig, env, strategy) {\n    const { region, enableStream } = providerConfig;\n    try {\n        const { url, options } = strategy.buildRequest(token, providerConfig);\n        const response = await secureProxiedFetch(url, options, region, env);\n\n        if (response.ok) {\n            let result = { token, isValid: true };\n            if (enableStream) {\n                const reader = response.body.getReader();\n                try {\n                    const { done } = await reader.read();\n                    if (done) return { token, isValid: false, message: \"\u9A8C\u8BC1\u5931\u8D25 (\u6D41\u63D0\u524D\u7ED3\u675F)\", error: true };\n                    result.rawResponse = { note: \"Validation successful via streaming.\" };\n                } finally {\n                    // \u786E\u4FDD\u6B63\u786E\u91CA\u653E\u8D44\u6E90\n                    await reader.cancel().catch((err) => {\n                        console.warn('Stream cancel failed:', err.message);\n                    });\n                    reader.releaseLock();\n                }\n            } else {\n                result.rawResponse = await response.json().catch(() => ({ note: \"Failed to parse JSON response.\" }));\n            }\n\n            if (providerMeta.balanceCheck && balanceCheckers[providerMeta.balanceCheck]) {\n                const balanceResult = await balanceCheckers[providerMeta.balanceCheck](token, providerConfig.baseUrl, region, env);\n                Object.assign(result, balanceResult);\n            }\n            return result;\n        }\n\n        const error = await handleApiError(response);\n\n        if (strategy.onFail) {\n            const retryResult = await strategy.onFail(error, token, providerConfig, env);\n            if (retryResult) {\n                return retryResult;\n            }\n        }\n\n        return { token, isValid: false, message: error.message, rawError: error.rawError, error: true };\n\n    } catch (error) {\n        return { token, isValid: false, message: \"\u7F51\u7EDC\u9519\u8BEF\u6216\u672A\u77E5\u5F02\u5E38\", rawError: { content: error.message }, error: true };\n    }\n}\n\n/**\n * @description \u5B9A\u4E49\u4E86\u4E0D\u540C API \u98CE\u683C\u7684\u8BF7\u6C42\u6784\u5EFA\u548C\u5931\u8D25\u5904\u7406\u7B56\u7565\u3002\n */\nconst apiStrategies = {\n    openai: {\n        buildRequest: (token, providerConfig) => {\n            const { baseUrl, model, enableStream, validationPrompt, validationMaxTokens } = providerConfig;\n            const apiUrl = normalizeBaseUrl(baseUrl) + \"/chat/completions\";\n            const headers = { \"Content-Type\": \"application/json\", Authorization: \"Bearer \" + token };\n            const body = {\n                model,\n                messages: [{ role: \"user\", content: validationPrompt || \"Hi\" }],\n                max_tokens: validationMaxTokens || 1,\n                stream: enableStream || false\n            };\n            return { url: apiUrl, options: { method: \"POST\", headers, body: JSON.stringify(body) } };\n        },\n        onFail: async (error, token, providerConfig, env) => {\n            if (error.rawError?.content?.error?.code === 'unsupported_parameter' && error.rawError?.content?.error?.param === 'max_tokens') {\n                const { url, options } = apiStrategies.openai.buildRequest(token, providerConfig);\n                const newBody = JSON.parse(options.body);\n                delete newBody.max_tokens;\n                newBody.max_completion_tokens = providerConfig.validationMaxOutputTokens || 16;\n                options.body = JSON.stringify(newBody);\n                const retryStrategy = { buildRequest: () => ({ url, options }) };\n                return await _checkTokenTemplate(token, {}, providerConfig, env, retryStrategy);\n            }\n            return null;\n        }\n    },\n    openai_responses: {\n        buildRequest: (token, providerConfig) => {\n            const { baseUrl, model, enableStream, validationPrompt, validationMaxOutputTokens } = providerConfig;\n            const apiUrl = normalizeBaseUrl(baseUrl) + \"/responses\";\n            const headers = { \"Content-Type\": \"application/json\", Authorization: \"Bearer \" + token };\n            const body = {\n                model,\n                input: validationPrompt || \"You just need to reply Hi.\",\n                max_output_tokens: validationMaxOutputTokens || 16,\n                stream: enableStream || false\n            };\n            return { url: apiUrl, options: { method: \"POST\", headers, body: JSON.stringify(body) } };\n        }\n    },\n    anthropic: {\n        buildRequest: (token, providerConfig) => {\n            const { baseUrl, model, enableStream, validationPrompt, validationMaxTokens } = providerConfig;\n            const apiUrl = normalizeBaseUrl(baseUrl) + \"/messages\";\n            const headers = {\n                \"x-api-key\": token,\n                \"anthropic-version\": \"2023-06-01\",\n                \"Content-Type\": \"application/json\",\n                \"anthropic-dangerous-direct-browser-access\": \"true\"\n            };\n            const body = {\n                model,\n                max_tokens: validationMaxTokens || 1,\n                messages: [{ role: \"user\", content: validationPrompt || \"You just need to reply Hi.\" }],\n                stream: enableStream || false,\n            };\n            return { url: apiUrl, options: { method: \"POST\", headers, body: JSON.stringify(body) } };\n        }\n    },\n    gemini: {\n        buildRequest: (token, providerConfig) => {\n            const { baseUrl, model, enableStream, validationPrompt, validationMaxOutputTokens } = providerConfig;\n            const endpoint = enableStream ? 'streamGenerateContent' : 'generateContent';\n            const apiUrl = `${normalizeBaseUrl(baseUrl)}/v1beta/models/${model}:${endpoint}`;\n            const headers = { \"Content-Type\": \"application/json\", \"x-goog-api-key\": token };\n            const body = {\n                contents: [{ parts: [{ text: validationPrompt || \"You just need to reply Hi.\" }] }],\n                generationConfig: { maxOutputTokens: validationMaxOutputTokens || 16 }\n            };\n            return { url: apiUrl, options: { method: \"POST\", headers, body: JSON.stringify(body) } };\n        }\n    },\n    tavily: {\n        buildRequest: (token, providerConfig) => {\n            const { baseUrl } = providerConfig;\n            const apiUrl = normalizeBaseUrl(baseUrl) + \"/search\";\n            const headers = { \"Content-Type\": \"application/json\" };\n            const body = {\n                api_key: token,\n                query: \"test\",\n                search_depth: \"basic\",\n                max_results: 1\n            };\n            return { url: apiUrl, options: { method: \"POST\", headers, body: JSON.stringify(body) } };\n        }\n    }\n};\n\nasync function checkOpenAICompatibleToken(token, providerMeta, providerConfig, env) {\n    return await _checkTokenTemplate(token, providerMeta, providerConfig, env, apiStrategies.openai);\n}\n\nasync function checkOpenAIResponsesToken(token, providerMeta, providerConfig, env) {\n    return await _checkTokenTemplate(token, providerMeta, providerConfig, env, apiStrategies.openai_responses);\n}\n\nasync function checkAnthropicToken(token, providerMeta, providerConfig, env) {\n    return await _checkTokenTemplate(token, providerMeta, providerConfig, env, apiStrategies.anthropic);\n}\n\nasync function checkGeminiToken(token, providerMeta, providerConfig, env) {\n    return await _checkTokenTemplate(token, providerMeta, providerConfig, env, apiStrategies.gemini);\n}\n\nasync function checkTavilyToken(token, providerMeta, providerConfig, env) {\n    return await _checkTokenTemplate(token, providerMeta, providerConfig, env, apiStrategies.tavily);\n}\n\n/**\n * @description \u68C0\u6D4B\u5355\u4E2A API Key \u7684\u6709\u6548\u6027\u3001\u989D\u5EA6\u7B49\u4FE1\u606F\u3002\n * \u8FD9\u662F\u66B4\u9732\u7ED9\u5916\u90E8\uFF08\u5982 websocket_handler\uFF09\u7684\u4E3B\u8981\u51FD\u6570\u3002\n * @param {string} token - \u8981\u68C0\u6D4B\u7684 API Key\u3002\n * @param {object} providerMeta - \u63D0\u4F9B\u5546\u7684\u5143\u6570\u636E\uFF0C\u6765\u81EA providers.json\u3002\n * @param {object} providerConfig - \u7528\u6237\u914D\u7F6E\u7684\u63D0\u4F9B\u5546\u4FE1\u606F\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<object>} - \u68C0\u6D4B\u7ED3\u679C\u5BF9\u8C61\u3002\n */\nexport async function checkToken(token, providerMeta, providerConfig, env) {\n    let checkerFunction;\n    switch (providerMeta.apiStyle) {\n        case \"openai\":\n            checkerFunction = checkOpenAICompatibleToken;\n            break;\n        case \"openai_responses\":\n            checkerFunction = checkOpenAIResponsesToken;\n            break;\n        case \"anthropic\":\n            checkerFunction = checkAnthropicToken;\n            break;\n        case \"gemini\":\n            checkerFunction = checkGeminiToken;\n            break;\n        case \"tavily\":\n            checkerFunction = checkTavilyToken;\n            break;\n        default:\n            return { token, isValid: false, message: \"\u4E0D\u652F\u6301\u7684\u63D0\u4F9B\u5546\u7C7B\u578B\", error: true };\n    }\n    return await checkerFunction(token, providerMeta, providerConfig, env);\n}\n", "{\n  \"openai\": {\n    \"label\": \"OpenAI\",\n    \"icon\": \"\uD83E\uDD16\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.openai.com/v1\",\n    \"defaultModel\": \"gpt-5\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"openai_responses\": {\n    \"label\": \"OpenAI (Responses API)\",\n    \"icon\": \"\uD83D\uDD2C\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai_responses\",\n    \"defaultBase\": \"https://api.openai.com/v1\",\n    \"defaultModel\": \"gpt-5\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"anthropic\": {\n    \"label\": \"Anthropic\",\n    \"icon\": \"\uD83D\uDD2E\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"anthropic\",\n    \"defaultBase\": \"https://api.anthropic.com/v1\",\n    \"defaultModel\": \"claude-3-5-haiku-20241022\",\n    \"fetchModels\": \"fetchAnthropicModels\"\n  },\n  \"gemini\": {\n    \"label\": \"Google Gemini\",\n    \"icon\": \"\u2728\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"gemini\",\n    \"defaultBase\": \"https://generativelanguage.googleapis.com\",\n    \"defaultModel\": \"gemini-2.5-flash-lite\",\n    \"fetchModels\": \"fetchGoogleModels\"\n  },\n  \"cerebras\": {\n    \"label\": \"Cerebras\",\n    \"icon\": \"\uD83D\uDC22\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.cerebras.ai/v1\",\n    \"defaultModel\": \"gpt-oss-120b\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"chutes\": {\n    \"label\": \"Chutes\",\n    \"icon\": \"\uD83D\uDC16\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://llm.chutes.ai/v1\",\n    \"defaultModel\": \"openai/gpt-oss-20b\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"deepinfra\": {\n    \"label\": \"Deepinfra\",\n    \"icon\": \"\uD83D\uDC53\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.deepinfra.com/v1/openai\",\n    \"defaultModel\": \"zai-org/GLM-4.5-Air\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"deepseek\": {\n    \"label\": \"DeepSeek\",\n    \"icon\": \"\uD83D\uDD0D\",\n    \"hasBalance\": true,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.deepseek.com/v1\",\n    \"defaultModel\": \"deepseek-chat\",\n    \"balanceCheck\": \"checkDeepSeekBalance\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"fireworks\": {\n    \"label\": \"Fireworks\",\n    \"icon\": \"\uD83D\uDD25\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.fireworks.ai/inference/v1\",\n    \"defaultModel\": \"accounts/fireworks/models/glm-4p5-air\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"friendli\": {\n    \"label\": \"Friendli\",\n    \"icon\": \"\uD83E\uDDA2\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.friendli.ai/serverless/v1\",\n    \"defaultModel\": \"Qwen/Qwen3-32B\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"github\": {\n    \"label\": \"GitHub Models\",\n    \"icon\": \"\uD83D\uDC19\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://models.github.ai/inference\",\n    \"defaultModel\": \"openai/gpt-4o-mini\",\n    \"fetchModels\": \"fetchGitHubModels\"\n  },\n  \"groq\": {\n    \"label\": \"Groq\",\n    \"icon\": \"\uD83D\uDC31\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.groq.com/openai/v1\",\n    \"defaultModel\": \"openai/gpt-oss-20b\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"modelscope\": {\n    \"label\": \"Modelscope\",\n    \"icon\": \"\uD83C\uDF44\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api-inference.modelscope.cn/v1\",\n    \"defaultModel\": \"ZhipuAI/GLM-4.5\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"moonshot\": {\n    \"label\": \"Moonshot\",\n    \"icon\": \"\uD83C\uDF19\",\n    \"hasBalance\": true,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.moonshot.cn/v1\",\n    \"defaultModel\": \"kimi-latest\",\n    \"balanceCheck\": \"checkMoonshotBalance\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"newapi\": {\n    \"label\": \"New API\",\n    \"icon\": \"\uD83C\uDF1F\",\n    \"hasBalance\": true,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://your.newapi.server/v1\",\n    \"defaultModel\": \"gpt-4o-mini\",\n    \"balanceCheck\": \"checkNewAPIBalance\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"novita\": {\n    \"label\": \"Novita\",\n    \"icon\": \"\uD83D\uDC20\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.novita.ai/openai\",\n    \"defaultModel\": \"zai-org/glm-4.5\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"openrouter\": {\n    \"label\": \"OpenRouter\",\n    \"icon\": \"\uD83C\uDF10\",\n    \"hasBalance\": true,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://openrouter.ai/api/v1\",\n    \"defaultModel\": \"mistralai/mistral-7b-instruct:free\",\n    \"balanceCheck\": \"checkOpenRouterBalance\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"poe\": {\n    \"label\": \"Poe\",\n    \"icon\": \"\uD83D\uDC27\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.poe.com/v1\",\n    \"defaultModel\": \"GPT-OSS-20B\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"pplx\": {\n    \"label\": \"Perplexity\",\n    \"icon\": \"\uD83C\uDF40\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.perplexity.ai\",\n    \"defaultModel\": \"sonar\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"qwen\": {\n    \"label\": \"Qwen\",\n    \"icon\": \"\u2601\uFE0F\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://dashscope.aliyuncs.com/compatible-mode/v1\",\n    \"defaultModel\": \"qwen-turbo\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"sambanova\": {\n    \"label\": \"Sambanova\",\n    \"icon\": \"\uD83D\uDC2E\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.sambanova.ai/v1\",\n    \"defaultModel\": \"DeepSeek-V3.1\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"siliconflow\": {\n    \"label\": \"SiliconFlow\",\n    \"icon\": \"\uD83D\uDCA7\",\n    \"hasBalance\": true,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.siliconflow.cn/v1\",\n    \"defaultModel\": \"Qwen/Qwen2.5-7B-Instruct\",\n    \"balanceCheck\": \"checkSiliconFlowBalance\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"together\": {\n    \"label\": \"Together\",\n    \"icon\": \"\uD83E\uDD1D\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.together.xyz/v1\",\n    \"defaultModel\": \"zai-org/GLM-4.5-Air-FP8\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"xai\": {\n    \"label\": \"xAI\",\n    \"icon\": \"\uD83D\uDE80\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://api.x.ai/v1\",\n    \"defaultModel\": \"grok-3-latest\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"zhipu\": {\n    \"label\": \"Zhipu\",\n    \"icon\": \"\u303D\uFE0F\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://open.bigmodel.cn/api/paas/v4\",\n    \"defaultModel\": \"glm-4.5-air\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  },\n  \"tavily\": {\n    \"label\": \"Tavily\",\n    \"icon\": \"\uD83C\uDF10\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"tavily\",\n    \"defaultBase\": \"https://api.tavily.com\",\n    \"defaultModel\": \"\"\n  },\n  \"custom\": {\n    \"label\": \"Custom (OpenAI \u517C\u5BB9)\",\n    \"icon\": \"\u2699\uFE0F\",\n    \"hasBalance\": false,\n    \"apiStyle\": \"openai\",\n    \"defaultBase\": \"https://your-api-endpoint.com/v1\",\n    \"defaultModel\": \"gpt-3.5-turbo\",\n    \"fetchModels\": \"fetchOpenAIModels\"\n  }\n}", "import * as checker from './checkers.js';\nimport * as providersData from '../config/providers.json';\n\n/**\n * @description TaskManager \u7C7B\u8D1F\u8D23\u5904\u7406\u5355\u4E2A\u3001\u6709\u9650\u5927\u5C0F\u7684\u6279\u6B21\u3002\n * \u5B83\u5728\u4E00\u4E2A\u72EC\u7ACB\u7684 WebSocket \u4F1A\u8BDD\u4E2D\u5B8C\u6210\u4E00\u4E2A\u6279\u6B21\u7684\u5904\u7406\u3002\n */\nclass TaskManager {\n    /**\n     * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n     * @param {object} callbacks - \u5305\u542B onResult, onStatus, onError, onDone \u7B49\u56DE\u8C03\u51FD\u6570\u3002\n     */\n    constructor(env, { onResult, onStatus, onError, onDone }) {\n        this.env = env;\n        this.callbacks = { onResult, onStatus, onError, onDone };\n\n        this.queue = [];\n        this.currentIndex = 0; // \u4F7F\u7528\u7D22\u5F15\u66FF\u4EE3 shift() \u907F\u514D\u7ADE\u4E89\u6761\u4EF6\n        this.isStopped = false;\n        this.concurrency = 5;\n        this.providerMeta = null;\n        this.providerConfig = null;\n    }\n\n    /**\n     * @description \u7EBF\u7A0B\u5B89\u5168\u5730\u83B7\u53D6\u4E0B\u4E00\u4E2A\u4EFB\u52A1\u9879\u3002\n     * @returns {object|null} - \u4E0B\u4E00\u4E2A\u4EFB\u52A1\u9879\uFF0C\u5982\u679C\u961F\u5217\u4E3A\u7A7A\u5219\u8FD4\u56DE null\u3002\n     */\n    getNextItem() {\n        if (this.currentIndex >= this.queue.length) return null;\n        return this.queue[this.currentIndex++];\n    }\n\n    /**\n     * @description \u5F00\u59CB\u5904\u7406\u63A5\u6536\u5230\u7684\u4E00\u4E2A\u6279\u6B21\u4EFB\u52A1\u3002\n     * @param {object} initialData - \u5305\u542B tokens, providerConfig, concurrency \u7684\u521D\u59CB\u6570\u636E\u3002\n     */\n    start(initialData) {\n        const { tokens, providerConfig, concurrency } = initialData;\n\n        if (!tokens || !Array.isArray(tokens) || !providerConfig) {\n            this.callbacks.onError('Invalid initial data for a batch');\n            return;\n        }\n\n        // \u4F7F\u7528\u524D\u7AEF\u4F20\u6765\u7684 tokens \u6570\u7EC4\u3002\n        this.queue = tokens;\n\n        this.concurrency = concurrency || 5;\n        this.providerConfig = providerConfig;\n        this.providerMeta = providersData.default[providerConfig.provider];\n\n        if (!this.providerMeta) {\n            this.callbacks.onError(`Provider '${providerConfig.provider}' not found`);\n            return;\n        }\n        \n        this.runWorkerPool();\n    }\n\n    /**\n     * @description \u521B\u5EFA\u5E76\u8FD0\u884C\u4E00\u4E2A\u5E76\u53D1\u5DE5\u4F5C\u6C60\u6765\u5904\u7406\u5F53\u524D\u6279\u6B21\u7684\u4EFB\u52A1\u3002\n     */\n    async runWorkerPool() {\n        const workerPromises = [];\n        for (let i = 0; i < this.concurrency; i++) {\n            const worker = async () => {\n                while (true) {\n                    if (this.isStopped) break;\n\n                    const item = this.getNextItem();\n                    if (!item) break;\n\n                    await this.runCheck(item);\n\n                    await new Promise(r => setTimeout(r, 0));\n                }\n            };\n            workerPromises.push(worker());\n        }\n\n        await Promise.all(workerPromises);\n\n        if (!this.isStopped) {\n            this.callbacks.onDone('Batch processing complete');\n        }\n    }\n\n    /**\n     * @description \u8FD0\u884C\u5355\u4E2A Key \u7684\u68C0\u6D4B\u3002\n     * @param {object} item - \u5305\u542B token \u548C order \u7684\u4EFB\u52A1\u9879\u3002\n     */\n    async runCheck(item) {\n        if (this.isStopped) return;\n        try {\n            // \u4ECE item \u5BF9\u8C61\u4E2D\u6B63\u786E\u5730\u53D6\u51FA token \u5B57\u7B26\u4E32\u8FDB\u884C\u68C0\u6D4B\n            const result = await checker.checkToken(item.token, this.providerMeta, this.providerConfig, this.env);\n            this.callbacks.onResult({ ...result, order: item.order });\n        } catch (e) {\n            this.callbacks.onResult({ token: item.token, message: e.message, error: true, order: item.order });\n        }\n    }\n\n    /**\n     * @description \u505C\u6B62\u5F53\u524D\u6279\u6B21\u7684\u4EFB\u52A1\u3002\n     */\n    stop() {\n        this.isStopped = true;\n    }\n}\n\n/**\n * @description \u5904\u7406 WebSocket \u4F1A\u8BDD\u7684\u5165\u53E3\u51FD\u6570\u3002\u6BCF\u4E2A\u4F1A\u8BDD\u5904\u7406\u4E00\u4E2A\u6279\u6B21\u7684\u68C0\u6D4B\u4EFB\u52A1\u3002\n * @param {WebSocket} ws - WebSocket \u670D\u52A1\u5668\u7AEF\u5B9E\u4F8B\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<void>}\n */\nexport function handleWebSocketSession(ws, env) {\n    ws.accept();\n\n    const taskManager = new TaskManager(env, {\n        onResult: (result) => ws.send(JSON.stringify({ type: 'result', data: result })),\n        onStatus: (message) => ws.send(JSON.stringify({ type: 'status', message })),\n        onError: (message) => {\n            ws.send(JSON.stringify({ type: 'error', message }));\n            ws.close(1011, message);\n        },\n        onDone: (message) => {\n            ws.send(JSON.stringify({ type: 'done', message }));\n            ws.close(1000, 'Work complete');\n        },\n    });\n\n    return new Promise((resolve, reject) => {\n        ws.addEventListener('message', event => {\n            try {\n                const message = JSON.parse(event.data);\n                if (message.command === 'start') {\n                    taskManager.start(message.data);\n                } else if (message.command === 'stop') {\n                    taskManager.stop();\n                    ws.close(1000, 'Client requested stop');\n                } else {\n                    ws.send(JSON.stringify({ type: 'error', message: 'Unknown command for this session' }));\n                }\n            } catch (e) {\n                ws.send(JSON.stringify({ type: 'error', message: 'Invalid JSON message' }));\n            }\n        });\n\n        const closeOrErrorHandler = (err) => {\n            taskManager.stop();\n            if (err) {\n                console.error('WebSocket error:', err);\n                reject(err);\n            } else {\n                resolve();\n            }\n        };\n\n        ws.addEventListener('close', () => closeOrErrorHandler());\n        ws.addEventListener('error', (err) => closeOrErrorHandler(err));\n    });\n}\n", "import { secureProxiedFetch } from './utils/fetcher.js';\nimport { normalizeBaseUrl } from './utils/url.js';\nimport * as providersData from '../config/providers.json';\n\nconst PROVIDERS = providersData.default;\n\n/**\n * @description \u4ECE OpenAI \u517C\u5BB9 API \u83B7\u53D6\u6A21\u578B\u5217\u8868\u3002\n * @param {string} token - API Key\u3002\n * @param {string} baseUrl - API \u57FA\u7840 URL\u3002\n * @param {string} region - \u533A\u57DF\u4FE1\u606F\u3002\n * @param {object} env - \u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<string[]>} - \u6A21\u578B ID \u6570\u7EC4\u3002\n */\nasync function fetchOpenAIModels(token, baseUrl, region, env) {\n    const apiUrl = normalizeBaseUrl(baseUrl) + \"/models\";\n    const response = await secureProxiedFetch(apiUrl, { method: \"GET\", headers: { Authorization: \"Bearer \" + token } }, region, env);\n    if (!response.ok) throw new Error(\"HTTP \" + response.status + \": \" + (await response.text()));\n    const data = await response.json();\n    if (Array.isArray(data)) return data.map((m) => m.id);\n    if (data && Array.isArray(data.data)) return data.data.map((m) => m.id);\n    return [];\n}\n\n/**\n * @description \u4ECE GitHub Models API \u83B7\u53D6\u6A21\u578B\u5217\u8868\uFF0C\u5305\u542B\u56DE\u9000\u903B\u8F91\u3002\n * @param {string} token - API Key\u3002\n * @param {string} baseUrl - API \u57FA\u7840 URL\u3002\n * @param {string} region - \u533A\u57DF\u4FE1\u606F\u3002\n * @param {object} env - \u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<string[]>} - \u6A21\u578B ID \u6570\u7EC4\u3002\n */\nasync function fetchGitHubModels(token, baseUrl, region, env) {\n    try {\n        const models = await fetchOpenAIModels(token, baseUrl, region, env);\n        if (models && models.length > 0) return models;\n    } catch (error) {\n        console.warn(\"GitHub /models endpoint failed, trying fallback...\", error.message);\n    }\n    const apiUrl = normalizeBaseUrl(baseUrl || PROVIDERS.github.defaultBase).replace(\"/inference\", \"\") + \"/catalog/models\";\n    const response = await secureProxiedFetch(apiUrl, { method: \"GET\", headers: { Authorization: \"Bearer \" + token } }, region, env);\n    if (!response.ok) throw new Error(\"Fallback /catalog/models failed with HTTP \" + response.status + \": \" + (await response.text()));\n    const data = await response.json();\n    if (data && Array.isArray(data.data) && data.data.length > 0) return data.data.map((m) => m.id);\n    if (Array.isArray(data) && data.length > 0) return data.map((m) => m.id);\n    throw new Error(\"Fallback /catalog/models returned no models.\");\n}\n\n/**\n * @description \u4ECE Google Gemini API \u83B7\u53D6\u6A21\u578B\u5217\u8868\u3002\n * @param {string} token - API Key\u3002\n * @param {string} baseUrl - API \u57FA\u7840 URL\u3002\n * @param {string} region - \u533A\u57DF\u4FE1\u606F\u3002\n * @param {object} env - \u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<string[]>} - \u6A21\u578B ID \u6570\u7EC4\u3002\n */\nasync function fetchGoogleModels(token, baseUrl, region, env) {\n    const apiUrl = `${normalizeBaseUrl(baseUrl)}/v1beta/models`;\n    const response = await secureProxiedFetch(\n        apiUrl,\n        {\n            method: \"GET\",\n            headers: { \"x-goog-api-key\": token }\n        },\n        region,\n        env\n    );\n\n    if (!response.ok) {\n        const err = await response.json().catch(() => null);\n        throw new Error(err?.error?.message || `HTTP ${response.status}`);\n    }\n\n    const data = await response.json();\n    return data.models\n        .filter((m) => m.supportedGenerationMethods?.includes(\"generateContent\") && !m.name.includes(\"embedding\"))\n        .map((m) => m.name.replace(\"models/\", \"\"));\n}\n\n/**\n * @description \u4ECE Anthropic API \u83B7\u53D6\u6A21\u578B\u5217\u8868\u3002\n * @param {string} token - API Key\u3002\n * @param {string} baseUrl - API \u57FA\u7840 URL\u3002\n * @param {string} region - \u533A\u57DF\u4FE1\u606F\u3002\n * @param {object} env - \u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<string[]>} - \u6A21\u578B ID \u6570\u7EC4\u3002\n */\nasync function fetchAnthropicModels(token, baseUrl, region, env) {\n    const apiUrl = normalizeBaseUrl(baseUrl) + \"/models\";\n    const response = await secureProxiedFetch(apiUrl, {\n        method: \"GET\",\n        headers: { \"x-api-key\": token, \"anthropic-version\": \"2023-06-01\", \"anthropic-dangerous-direct-browser-access\": \"true\" },\n    }, region, env);\n    if (!response.ok) {\n        const err = await response.json().catch(() => null);\n        throw new Error(err?.error?.message || `HTTP ${response.status}`);\n    }\n    const data = await response.json();\n    return data.data.map((model) => model.id);\n}\n\n/**\n * @description \u6620\u5C04\u4E0D\u540C\u63D0\u4F9B\u5546\u7684\u6A21\u578B\u83B7\u53D6\u51FD\u6570\u3002\n */\nconst fetcherMap = {\n    fetchOpenAIModels,\n    fetchGitHubModels,\n    fetchGoogleModels,\n    fetchAnthropicModels\n};\n\n/**\n * @description \u6839\u636E\u63D0\u4F9B\u5546\u5143\u6570\u636E\u83B7\u53D6\u6A21\u578B\u5217\u8868\u3002\n * @param {object} providerMeta - \u63D0\u4F9B\u5546\u7684\u5143\u6570\u636E\u3002\n * @param {string} token - API Key\u3002\n * @param {object} providerConfig - \u63D0\u4F9B\u5546\u914D\u7F6E\u3002\n * @param {object} env - \u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<string[]>} - \u6A21\u578B ID \u6570\u7EC4\u3002\n * @throws {Error} \u5982\u679C\u63D0\u4F9B\u5546\u4E0D\u652F\u6301\u6A21\u578B\u83B7\u53D6\u3002\n */\nexport async function getModels(providerMeta, token, providerConfig, env) {\n    const fetcherName = providerMeta.fetchModels;\n    if (!fetcherName || !fetcherMap[fetcherName]) {\n        throw new Error(`Model fetching is not supported for provider: ${providerConfig.provider}`);\n    }\n    return await fetcherMap[fetcherName](token, providerConfig.baseUrl, providerConfig.region, env);\n}\n", "import { corsHeaders, handleOptions } from './utils/cors.js';\nimport { handleWebSocketSession } from './websocket_handler.js';\nimport * as modelFetcher from './model_fetchers.js';\nimport * as providersData from '../config/providers.json';\n\n/**\n * @description Durable Object (DO) \u7528\u4E8E\u4ECE\u6307\u5B9A\u7684 Cloudflare \u533A\u57DF\u53D1\u8D77\u7F51\u7EDC\u8BF7\u6C42\u3002\n * \u5B83\u63A5\u6536\u4E00\u4E2A\u5185\u90E8\u8BF7\u6C42\uFF0C\u89E3\u6790\u51FA\u771F\u6B63\u7684\u76EE\u6807 URL \u548C\u53C2\u6570\uFF0C\u7136\u540E\u4ECE\u8BE5 DO \u6240\u5728\u7684\u533A\u57DF\u53D1\u8D77 fetch\u3002\n */\nexport class RegionalFetcher {\n    constructor(state, env) {\n        this.state = state;\n        this.env = env;\n    }\n\n    async fetch(request) {\n        const { targetUrl, method, headers, body } = await request.json();\n        const upstreamRequest = new Request(targetUrl, {\n            method,\n            headers,\n            body: typeof body === 'object' ? JSON.stringify(body) : body\n        });\n        return fetch(upstreamRequest);\n    }\n}\n\n/**\n * @description \u5904\u7406 /models API \u8BF7\u6C42\uFF0C\u7528\u4E8E\u83B7\u53D6\u6307\u5B9A\u63D0\u4F9B\u5546\u7684\u53EF\u7528\u6A21\u578B\u5217\u8868\u3002\n * @param {Request} request - \u4F20\u5165\u7684\u8BF7\u6C42\u5BF9\u8C61\u3002\n * @param {object} env - Cloudflare Worker \u7684\u73AF\u5883\u53D8\u91CF\u3002\n * @returns {Promise<Response>} - \u5305\u542B\u6A21\u578B\u5217\u8868\u6216\u9519\u8BEF\u4FE1\u606F\u7684\u54CD\u5E94\u3002\n */\nasync function handleModelsRequest(request, env) {\n    if (request.method !== 'POST') {\n        return new Response('Method Not Allowed', { status: 405 });\n    }\n\n    let requestBody;\n    try {\n        requestBody = await request.json();\n    } catch (e) {\n        return new Response('Invalid JSON in request body', { status: 400 });\n    }\n\n    const { token, providerConfig } = requestBody;\n    if (!token || !providerConfig) {\n        return new Response('Invalid request body', { status: 400 });\n    }\n\n    const providerMeta = providersData.default[providerConfig.provider];\n    if (!providerMeta) {\n        return new Response(`Provider '${providerConfig.provider}' not found`, { status: 400 });\n    }\n\n    try {\n        const models = await modelFetcher.getModels(providerMeta, token, providerConfig, env);\n        const responseHeaders = corsHeaders(request, env);\n        responseHeaders['Content-Type'] = 'application/json';\n        return new Response(JSON.stringify(models), { headers: responseHeaders });\n    } catch (error) {\n        const responseHeaders = corsHeaders(request, env);\n        responseHeaders['Content-Type'] = 'application/json';\n        return new Response(JSON.stringify({ error: error.message }), {\n            status: 500,\n            headers: responseHeaders,\n        });\n    }\n}\n\n/**\n * @description Cloudflare Worker \u7684\u4E3B\u5165\u53E3\u70B9\u3002\n * \u5B83\u5904\u7406\u6240\u6709\u4F20\u5165\u7684 HTTP \u8BF7\u6C42\uFF0C\u5E76\u6839\u636E\u8DEF\u5F84\u8DEF\u7531\u5230\u4E0D\u540C\u7684\u5904\u7406\u5668\u3002\n */\nexport default {\n    async fetch(request, env, ctx) {\n        const url = new URL(request.url);\n        const pathname = url.pathname;\n\n        // \u5904\u7406 CORS \u9884\u68C0\u8BF7\u6C42\n        if (request.method === 'OPTIONS') {\n            return handleOptions(request, env);\n        }\n\n        // /check \u8DEF\u5F84\u7528\u4E8E WebSocket \u8FDE\u63A5\uFF0C\u5904\u7406\u5B9E\u65F6\u68C0\u6D4B\u4EFB\u52A1\n        if (pathname === '/check') {\n            const upgradeHeader = request.headers.get('Upgrade');\n            if (upgradeHeader !== 'websocket') {\n                return new Response('Expected a WebSocket upgrade request', { status: 426 });\n            }\n\n            const [client, server] = Object.values(new WebSocketPair());\n            \n            // \u5C06 WebSocket \u4F1A\u8BDD\u5904\u7406\u59D4\u6258\u7ED9 handler\uFF0C\u5E76\u786E\u4FDD Worker \u5728\u4F1A\u8BDD\u671F\u95F4\u4FDD\u6301\u6D3B\u52A8\u72B6\u6001\n            ctx.waitUntil(handleWebSocketSession(server, env));\n\n            const responseHeaders = corsHeaders(request, env);\n\n            // \u8FD4\u56DE 101 \u54CD\u5E94\uFF0C\u5347\u7EA7\u8FDE\u63A5\u5230 WebSocket\n            return new Response(null, {\n                status: 101,\n                webSocket: client,\n                headers: responseHeaders,\n            });\n        }\n\n        // /models \u8DEF\u5F84\u7528\u4E8E\u83B7\u53D6\u6A21\u578B\u5217\u8868\n        if (pathname === '/models') {\n            return handleModelsRequest(request, env);\n        }\n\n        // \u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5C1D\u8BD5\u63D0\u4F9B\u9759\u6001\u8D44\u6E90\uFF08\u524D\u7AEF\u5E94\u7528\uFF09\n        try {\n            return await env.ASSETS.fetch(request);\n        } catch (e) {\n            return new Response(\"\u9759\u6001\u8D44\u6E90\u670D\u52A1\u914D\u7F6E\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5 wrangler.toml\u3002\", { status: 500 });\n        }\n    },\n};", "import type { Middleware } from \"./common\";\n\nconst drainBody: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} finally {\n\t\ttry {\n\t\t\tif (request.body !== null && !request.bodyUsed) {\n\t\t\t\tconst reader = request.body.getReader();\n\t\t\t\twhile (!(await reader.read()).done) {}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.error(\"Failed to drain the unused request body.\", e);\n\t\t}\n\t}\n};\n\nexport default drainBody;\n", "import type { Middleware } from \"./common\";\n\ninterface JsonError {\n\tmessage?: string;\n\tname?: string;\n\tstack?: string;\n\tcause?: JsonError;\n}\n\nfunction reduceError(e: any): JsonError {\n\treturn {\n\t\tname: e?.name,\n\t\tmessage: e?.message ?? String(e),\n\t\tstack: e?.stack,\n\t\tcause: e?.cause === undefined ? undefined : reduceError(e.cause),\n\t};\n}\n\n// See comment in `bundle.ts` for details on why this is needed\nconst jsonError: Middleware = async (request, env, _ctx, middlewareCtx) => {\n\ttry {\n\t\treturn await middlewareCtx.next(request, env);\n\t} catch (e: any) {\n\t\tconst error = reduceError(e);\n\t\treturn Response.json(error, {\n\t\t\tstatus: 500,\n\t\t\theaders: { \"MF-Experimental-Error-Stack\": \"true\" },\n\t\t});\n\t}\n};\n\nexport default jsonError;\n", "\t\t\t\timport worker, * as OTHER_EXPORTS from \"E:\\\\llm-api-key-checker\\\\src\\\\index.js\";\n\t\t\t\timport * as __MIDDLEWARE_0__ from \"E:\\\\llm-api-key-checker\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-ensure-req-body-drained.ts\";\nimport * as __MIDDLEWARE_1__ from \"E:\\\\llm-api-key-checker\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\middleware-miniflare3-json-error.ts\";\n\n\t\t\t\texport * from \"E:\\\\llm-api-key-checker\\\\src\\\\index.js\";\n\t\t\t\tconst MIDDLEWARE_TEST_INJECT = \"__INJECT_FOR_TESTING_WRANGLER_MIDDLEWARE__\";\n\t\t\t\texport const __INTERNAL_WRANGLER_MIDDLEWARE__ = [\n\t\t\t\t\t\n\t\t\t\t\t__MIDDLEWARE_0__.default,__MIDDLEWARE_1__.default\n\t\t\t\t]\n\t\t\t\texport default worker;", "export type Awaitable<T> = T | Promise<T>;\n// TODO: allow dispatching more events?\nexport type Dispatcher = (\n\ttype: \"scheduled\",\n\tinit: { cron?: string }\n) => Awaitable<void>;\n\nexport type IncomingRequest = Request<\n\tunknown,\n\tIncomingRequestCfProperties<unknown>\n>;\n\nexport interface MiddlewareContext {\n\tdispatch: Dispatcher;\n\tnext(request: IncomingRequest, env: any): Awaitable<Response>;\n}\n\nexport type Middleware = (\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tmiddlewareCtx: MiddlewareContext\n) => Awaitable<Response>;\n\nconst __facade_middleware__: Middleware[] = [];\n\n// The register functions allow for the insertion of one or many middleware,\n// We register internal middleware first in the stack, but have no way of controlling\n// the order that addMiddleware is run in service workers so need an internal function.\nexport function __facade_register__(...args: (Middleware | Middleware[])[]) {\n\t__facade_middleware__.push(...args.flat());\n}\nexport function __facade_registerInternal__(\n\t...args: (Middleware | Middleware[])[]\n) {\n\t__facade_middleware__.unshift(...args.flat());\n}\n\nfunction __facade_invokeChain__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tmiddlewareChain: Middleware[]\n): Awaitable<Response> {\n\tconst [head, ...tail] = middlewareChain;\n\tconst middlewareCtx: MiddlewareContext = {\n\t\tdispatch,\n\t\tnext(newRequest, newEnv) {\n\t\t\treturn __facade_invokeChain__(newRequest, newEnv, ctx, dispatch, tail);\n\t\t},\n\t};\n\treturn head(request, env, ctx, middlewareCtx);\n}\n\nexport function __facade_invoke__(\n\trequest: IncomingRequest,\n\tenv: any,\n\tctx: ExecutionContext,\n\tdispatch: Dispatcher,\n\tfinalMiddleware: Middleware\n): Awaitable<Response> {\n\treturn __facade_invokeChain__(request, env, ctx, dispatch, [\n\t\t...__facade_middleware__,\n\t\tfinalMiddleware,\n\t]);\n}\n", "// This loads all middlewares exposed on the middleware object and then starts\n// the invocation chain. The big idea is that we can add these to the middleware\n// export dynamically through wrangler, or we can potentially let users directly\n// add them as a sort of \"plugin\" system.\n\nimport ENTRY, { __INTERNAL_WRANGLER_MIDDLEWARE__ } from \"E:\\\\llm-api-key-checker\\\\.wrangler\\\\tmp\\\\bundle-Ctkbme\\\\middleware-insertion-facade.js\";\nimport { __facade_invoke__, __facade_register__, Dispatcher } from \"E:\\\\llm-api-key-checker\\\\node_modules\\\\wrangler\\\\templates\\\\middleware\\\\common.ts\";\nimport type { WorkerEntrypointConstructor } from \"E:\\\\llm-api-key-checker\\\\.wrangler\\\\tmp\\\\bundle-Ctkbme\\\\middleware-insertion-facade.js\";\n\n// Preserve all the exports from the worker\nexport * from \"E:\\\\llm-api-key-checker\\\\.wrangler\\\\tmp\\\\bundle-Ctkbme\\\\middleware-insertion-facade.js\";\n\nclass __Facade_ScheduledController__ implements ScheduledController {\n\treadonly #noRetry: ScheduledController[\"noRetry\"];\n\n\tconstructor(\n\t\treadonly scheduledTime: number,\n\t\treadonly cron: string,\n\t\tnoRetry: ScheduledController[\"noRetry\"]\n\t) {\n\t\tthis.#noRetry = noRetry;\n\t}\n\n\tnoRetry() {\n\t\tif (!(this instanceof __Facade_ScheduledController__)) {\n\t\t\tthrow new TypeError(\"Illegal invocation\");\n\t\t}\n\t\t// Need to call native method immediately in case uncaught error thrown\n\t\tthis.#noRetry();\n\t}\n}\n\nfunction wrapExportedHandler(worker: ExportedHandler): ExportedHandler {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn worker;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\tconst fetchDispatcher: ExportedHandlerFetchHandler = function (\n\t\trequest,\n\t\tenv,\n\t\tctx\n\t) {\n\t\tif (worker.fetch === undefined) {\n\t\t\tthrow new Error(\"Handler does not export a fetch() function.\");\n\t\t}\n\t\treturn worker.fetch(request, env, ctx);\n\t};\n\n\treturn {\n\t\t...worker,\n\t\tfetch(request, env, ctx) {\n\t\t\tconst dispatcher: Dispatcher = function (type, init) {\n\t\t\t\tif (type === \"scheduled\" && worker.scheduled !== undefined) {\n\t\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\t\tDate.now(),\n\t\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t\t() => {}\n\t\t\t\t\t);\n\t\t\t\t\treturn worker.scheduled(controller, env, ctx);\n\t\t\t\t}\n\t\t\t};\n\t\t\treturn __facade_invoke__(request, env, ctx, dispatcher, fetchDispatcher);\n\t\t},\n\t};\n}\n\nfunction wrapWorkerEntrypoint(\n\tklass: WorkerEntrypointConstructor\n): WorkerEntrypointConstructor {\n\t// If we don't have any middleware defined, just return the handler as is\n\tif (\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__ === undefined ||\n\t\t__INTERNAL_WRANGLER_MIDDLEWARE__.length === 0\n\t) {\n\t\treturn klass;\n\t}\n\t// Otherwise, register all middleware once\n\tfor (const middleware of __INTERNAL_WRANGLER_MIDDLEWARE__) {\n\t\t__facade_register__(middleware);\n\t}\n\n\t// `extend`ing `klass` here so other RPC methods remain callable\n\treturn class extends klass {\n\t\t#fetchDispatcher: ExportedHandlerFetchHandler<Record<string, unknown>> = (\n\t\t\trequest,\n\t\t\tenv,\n\t\t\tctx\n\t\t) => {\n\t\t\tthis.env = env;\n\t\t\tthis.ctx = ctx;\n\t\t\tif (super.fetch === undefined) {\n\t\t\t\tthrow new Error(\"Entrypoint class does not define a fetch() function.\");\n\t\t\t}\n\t\t\treturn super.fetch(request);\n\t\t};\n\n\t\t#dispatcher: Dispatcher = (type, init) => {\n\t\t\tif (type === \"scheduled\" && super.scheduled !== undefined) {\n\t\t\t\tconst controller = new __Facade_ScheduledController__(\n\t\t\t\t\tDate.now(),\n\t\t\t\t\tinit.cron ?? \"\",\n\t\t\t\t\t() => {}\n\t\t\t\t);\n\t\t\t\treturn super.scheduled(controller);\n\t\t\t}\n\t\t};\n\n\t\tfetch(request: Request<unknown, IncomingRequestCfProperties>) {\n\t\t\treturn __facade_invoke__(\n\t\t\t\trequest,\n\t\t\t\tthis.env,\n\t\t\t\tthis.ctx,\n\t\t\t\tthis.#dispatcher,\n\t\t\t\tthis.#fetchDispatcher\n\t\t\t);\n\t\t}\n\t};\n}\n\nlet WRAPPED_ENTRY: ExportedHandler | WorkerEntrypointConstructor | undefined;\nif (typeof ENTRY === \"object\") {\n\tWRAPPED_ENTRY = wrapExportedHandler(ENTRY);\n} else if (typeof ENTRY === \"function\") {\n\tWRAPPED_ENTRY = wrapWorkerEntrypoint(ENTRY);\n}\nexport default WRAPPED_ENTRY;\n"],
  "mappings": "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",
  "names": []
}
